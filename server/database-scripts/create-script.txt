/*=======================================================================================*/
/* CREATE QUERIES */
/*=======================================================================================*/
CREATE TABLE ROLES(
  ROLE_ID INT PRIMARY KEY,
  ROLE_NAME VARCHAR(200) NOT NULL,
  ROLE_CODE VARCHAR(200)
);

CREATE TABLE USERS(
  USER_ID INT PRIMARY KEY,
  USERNAME VARCHAR(200) NOT NULL,
  PASSWORD VARCHAR(200),
  STATUS VARCHAR(30)
);

CREATE TABLE ROLE_USER(
  ROLE_ID INT NOT NULL,
  USER_ID INT NOT NULL,
  FOREIGN KEY(ROLE_ID) REFERENCES ROLES(ROLE_ID) ON DELETE RESTRICT ON UPDATE CASCADE,
  FOREIGN KEY(USER_ID) REFERENCES USERS(USER_ID) ON DELETE RESTRICT ON UPDATE CASCADE,
  PRIMARY KEY(ROLE_ID, USER_ID)
);

CREATE TABLE ADMIN(
  ADMIN_ID INT PRIMARY KEY,
  USER_ID INT NOT NULL,
  ADMIN_NAME VARCHAR(200) NOT NULL,
  MOBILE INT,
  EMAIL VARCHAR(200),
  STATUS VARCHAR(30),
  FOREIGN KEY(USER_ID) REFERENCES USERS(USER_ID) ON DELETE RESTRICT ON UPDATE CASCADE
);

CREATE TABLE DISEASES(
  DISEASE_ID INT PRIMARY KEY,
  DISEASE_NAME VARCHAR(200) NOT NULL,
  CATEGORY VARCHAR(200) NOT NULL,
  DISEASE_CODE VARCHAR(200) UNIQUE NOT NULL
);

CREATE TABLE HOSPITALS(
  HOSPITAL_ID INT PRIMARY KEY,
  USER_ID INT NOT NULL,
  HOSPITAL_NAME VARCHAR(200) NOT NULL,
  EMAIL_ID VARCHAR(200),
  ADDRESS VARCHAR(500),
  CITY VARCHAR(200) NOT NULL,
  STATE VARCHAR(200) NOT NULL,
  COUNTRY VARCHAR(200) NOT NULL,
  PINCODE INT(10),
  STATUS VARCHAR(30),
  FOREIGN KEY(USER_ID) REFERENCES USERS(USER_ID) ON DELETE RESTRICT ON UPDATE CASCADE
);

CREATE TABLE DOCTORS(
  DOCTOR_ID INT PRIMARY KEY,
  USER_ID INT NOT NULL,
  FIRST_NAME VARCHAR(200) NOT NULL,
  LAST_NAME VARCHAR(200),
  DOB DATE NOT NULL,
  GENDER VARCHAR(10),
  MOBILE INT NOT NULL,
  STATUS VARCHAR(30),
  EMAIL_ID VARCHAR(200),
  ADDRESS VARCHAR(500),
  CITY VARCHAR(200) NOT NULL,
  STATE VARCHAR(200) NOT NULL,
  COUNTRY VARCHAR(200) NOT NULL,
  PINCODE INT(10),
  FOREIGN KEY(USER_ID) REFERENCES USERS(USER_ID) ON DELETE RESTRICT ON UPDATE CASCADE
);

CREATE TABLE HOSPITAL_DOCTOR_MAPPER(
  DOCTOR_ID INT NOT NULL,
  HOSPITAL_ID INT NOT NULL,  
  JOIN_DATE DATE NOT NULL,
  EXIT_DATE DATE,
  STATUS VARCHAR(200),
  FOREIGN KEY(HOSPITAL_ID) REFERENCES HOSPITALS(HOSPITAL_ID) ON DELETE RESTRICT ON UPDATE CASCADE,
  FOREIGN KEY(DOCTOR_ID) REFERENCES DOCTORS(DOCTOR_ID) ON DELETE RESTRICT ON UPDATE CASCADE,
  PRIMARY KEY(DOCTOR_ID, HOSPITAL_ID, JOIN_DATE)
);

CREATE TABLE PATIENTS(
  PATIENT_ID INT PRIMARY KEY,
  FIRST_NAME VARCHAR(200) NOT NULL,
  LAST_NAME VARCHAR(200),
  GENDER VARCHAR(30) NOT NULL,
  DOB DATE NOT NULL,
  MOBILE INT NOT NULL,
  EMAIL VARCHAR(200) NOT NULL,
  IDENTITY_TYPE VARCHAR(100),
  IDENTITY_VALUE VARCHAR(30),
  CITY VARCHAR(200) NOT NULL,
  STATE VARCHAR(200) NOT NULL,
  PINCODE INT NOT NULL
);

CREATE TABLE HOSPITAL_PATIENT_MAPPER(
  PATIENT_ID INT NOT NULL,
  HOSPITAL_ID INT NOT NULL,
  CHECK_IN TIMESTAMP NOT NULL,
  CHECK_OUT TIMESTAMP,
  STATUS VARCHAR(20),
  FOREIGN KEY(PATIENT_ID) REFERENCES PATIENTS(PATIENT_ID) ON DELETE RESTRICT ON UPDATE CASCADE,
  FOREIGN KEY(HOSPITAL_ID) REFERENCES HOSPITALS(HOSPITAL_ID) ON DELETE RESTRICT ON UPDATE CASCADE,
  PRIMARY KEY(
    PATIENT_ID,
    HOSPITAL_ID,
    CHECK_IN
  )
);

CREATE TABLE DISEASES(
  DISEASE_ID INT PRIMARY KEY,
  DISEASE_NAME VARCHAR(200) NOT NULL,
  CATEGORY VARCHAR(200) NOT NULL,
  DISEASE_CODE VARCHAR(200) UNIQUE NOT NULL
);


CREATE TABLE PATIENT_DISEASE_MAPPER(
  PATIENT_ID INT NOT NULL,
  HOSPITAL_ID INT NOT NULL,
  DISEASE_ID INT NOT NULL,
  FOREIGN KEY(PATIENT_ID) REFERENCES PATIENTS(PATIENT_ID) ON DELETE RESTRICT ON UPDATE CASCADE,
  FOREIGN KEY(HOSPITAL_ID) REFERENCES HOSPITALS(HOSPITAL_ID) ON DELETE RESTRICT ON UPDATE CASCADE,
  FOREIGN KEY(DISEASE_ID) REFERENCES DISEASES(DISEASE_ID) ON DELETE RESTRICT ON UPDATE CASCADE
);

CREATE TABLE DOCTOR_DISEASE_MAPPER(
  DOCTOR_ID INT NOT NULL,
  HOSPITAL_ID INT NOT NULL,
  DISEASE_ID INT NOT NULL,
  FOREIGN KEY(DOCTOR_ID) REFERENCES DOCTORS(DOCTOR_ID) ON DELETE RESTRICT ON UPDATE CASCADE,
  FOREIGN KEY(HOSPITAL_ID) REFERENCES HOSPITALS(HOSPITAL_ID) ON DELETE RESTRICT ON UPDATE CASCADE,
  FOREIGN KEY(DISEASE_ID) REFERENCES DISEASES(DISEASE_ID) ON DELETE RESTRICT ON UPDATE CASCADE
);

CREATE TABLE PATIENT_DOCTOR_MAPPER(
  PATIENT_ID INT NOT NULL,
  HOSPITAL_ID INT NOT NULL,
  DOCTOR_ID INT NOT NULL, 
  FROM_DATE TIMESTAMP NOT NULL,
  TO_DATE TIMESTAMP,
  STATUS VARCHAR(200),
  FOREIGN KEY(PATIENT_ID) REFERENCES PATIENTS(PATIENT_ID) ON DELETE RESTRICT ON UPDATE CASCADE,
  FOREIGN KEY(DOCTOR_ID) REFERENCES DOCTORS(DOCTOR_ID) ON DELETE RESTRICT ON UPDATE CASCADE,
  FOREIGN KEY(HOSPITAL_ID) REFERENCES HOSPITALS(HOSPITAL_ID) ON DELETE RESTRICT ON UPDATE CASCADE
);

CREATE TABLE MEDICAL_RECORDS(
  PATIENT_ID INT NOT NULL,
  DOCTOR_ID INT NOT NULL,
  HOSPITAL_ID INT NOT NULL,
  CHECK_TIMESTAMP TIMESTAMP NOT NULL,
  PRESCRIPTION VARCHAR(2000),
  FOREIGN KEY(PATIENT_ID) REFERENCES PATIENTS(PATIENT_ID) ON DELETE RESTRICT ON UPDATE CASCADE,
  FOREIGN KEY(DOCTOR_ID) REFERENCES DOCTORS(DOCTOR_ID) ON DELETE RESTRICT ON UPDATE CASCADE,
  FOREIGN KEY(HOSPITAL_ID) REFERENCES HOSPITALS(HOSPITAL_ID) ON DELETE RESTRICT ON UPDATE CASCADE,
  PRIMARY KEY(PATIENT_ID,DOCTOR_ID,HOSPITAL_ID,CHECK_TIMESTAMP )
);

